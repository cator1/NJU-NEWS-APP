{"version":3,"names":["_sfc_main","data","lecture","loaded","id","computed","userStore","store_user","useUserStore","watch","handler","tryFindLecture","immediate","deep","methods","fetchLectureById","_this","url","concat","common_vendor","index","showLoading","title","request","method","success","res","statusCode","Array","isArray","length","row","link","description","showToast","icon","fail","complete","hideLoading","openInBrowser","onLoad","options","wx","createPage","MiniProgramPage"],"sources":["lectureDetail.vue","cGFnZXMvdGFiYmFyL2xlY3R1cmUvbGVjdHVyZURldGFpbC52dWU"],"sourcesContent":["<template>\n  <view class=\"lecture-detail\">\n    <view v-if=\"lecture\">\n      <text class=\"title\" user-select>{{ lecture.title }}</text>\n      <view class=\"desc\">\n        <template v-for=\"(block, index) in (lecture.description || [])\" :key=\"index\">\r\n\t\t  <text v-if=\"block\" user-select>\r\n\t\t    {{ block.content }}\r\n\t\t  </text>\r\n\t\t</template>\n      </view>\n      <view v-if=\"lecture.link\" class=\"link\">\n        <text @click=\"openInBrowser(lecture.link)\">查看原文链接</text>\n      </view>\n    </view>\n\n    <!-- 加载完成但未找到讲座时才显示错误 -->\n    <view v-else-if=\"loaded\" class=\"error\">\n      <text>讲座不存在</text>\n    </view>\n  </view>\n</template>\n\n\n<script>\nimport { useUserStore } from '../../../store/user'\n\nexport default {\n  data() {\n    return {\n      lecture: null,\r\n\t  loaded: false,\r\n\t  id:null\n    };\n  },\n  computed: {\n    userStore() {\n      return useUserStore()\n    }\n  },\r\n  //监听Lecture数据是否加载完成\r\n  watch:{\r\n\t'userStore.userInfo':{\r\n\t\thandler(){\r\n\t\t\tthis.tryFindLecture()\r\n\t\t},\r\n\t\timmediate:true,\r\n\t\tdeep:true\r\n\t}\r\n  },\r\n  methods:{\r\n    fetchLectureById(id) {\n      if (!id) return;\n      const url = `http://52.184.65.42/api/query?id=${id}`;\n      uni.showLoading({ title: '加载中...' });\n\n      uni.request({\n        url,\n        method: 'GET',\n        success: (res) => {\n          if (res.statusCode === 200 && Array.isArray(res.data) && res.data.length > 0) {\n            const row = res.data[0];\n            this.lecture = {\n              title: row[3],      // 优先用真实标题\n              link: row[4],\n              description: row[5]\n            };\n          } else {\n            uni.showToast({ title: '讲座未找到', icon: 'none' });\n          }\n        },\n        fail: () => {\n          uni.showToast({ title: '请求失败，请检查网络', icon: 'none' });\n        },\n        complete: () => {\n          uni.hideLoading();\n          this.loaded = true;\n        }\n      });\n    },\r\n    openInBrowser(link) {\n      // #ifdef APP-PLUS\n      if (link) {\n        plus.runtime.openURL(link, function (res) {\n          console.log('打开外链失败', res);\n        });\n      }\n      // #endif\n\n      // #ifndef APP-PLUS\n      uni.showToast({\n        title: '仅支持App中打开外链',\n        icon: 'none'\n      });\n      // #endif\n    }\r\n  },\n  onLoad(options) {\n    if (options?.id) {\n      this.id = options.id;\n      this.fetchLectureById(this.id);\n    } else {\n      uni.showToast({ title: '参数缺失', icon: 'none' });\n      this.loaded = true;\n    }\n  }\n}\n</script>\n\n<style>\n.lecture-detail {\n  padding: 20rpx;\n}\n.title {\n  font-size: 20px;\n  font-weight: bold;\n  margin-bottom: 16rpx;\n}\n.desc {\n  font-size: 14px;\n  line-height: 1.8;\n  color: #333;\n  white-space: pre-wrap;\n}\n.link {\n  margin-top: 20rpx;\n}\n.error {\n  color: red;\n  font-size: 16px;\n  text-align: center;\n  margin-top: 100rpx;\n}\n</style>\n\r\n.desc-block {\n  font-size: 14px;\n  color: #333;\n  white-space: pre-wrap;\n  line-height: 1.8;\n  margin-bottom: 12rpx;\n}\n","import MiniProgramPage from 'D:/NJU/code/NJUnews/code/njunews/pages/tabbar/lecture/lectureDetail.vue'\nwx.createPage(MiniProgramPage)"],"mappings":";;;;;AA2BA,IAAKA,SAAA,GAAU;EACbC,IAAA,WAAAA,KAAA,EAAO;IACL,OAAO;MACLC,OAAA,EAAS;MACZC,MAAA,EAAQ;MACRC,EAAA,EAAG;IAAA;EAEH;EACDC,QAAA,EAAU;IACRC,SAAA,WAAAA,UAAA,EAAY;MACV,OAAOC,UAAA,CAAAC,YAAA,EAAa;IACtB;EACD;EAAA;EAEDC,KAAA,EAAM;IACP,sBAAqB;MACpBC,OAAA,WAAAA,QAAA,EAAS;QACR,KAAKC,cAAA,EAAe;MACpB;MACDC,SAAA,EAAU;MACVC,IAAA,EAAK;IACN;EACE;EACDC,OAAA,EAAQ;IACNC,gBAAA,WAAAA,iBAAiBX,EAAA,EAAI;MAAA,IAAAY,KAAA;MACnB,IAAI,CAACZ,EAAA,EAAI;MACT,IAAMa,GAAA,uCAAAC,MAAA,CAA0Cd,EAAE;MAClDe,aAAA,CAAAC,KAAA,CAAIC,WAAA,CAAY;QAAEC,KAAA,EAAO;MAAU;MAEnCH,aAAA,CAAAC,KAAA,CAAIG,OAAA,CAAQ;QACVN,GAAA,EAAAA,GAAA;QACAO,MAAA,EAAQ;QACRC,OAAA,EAAS,SAAAA,QAACC,GAAA,EAAQ;UAChB,IAAIA,GAAA,CAAIC,UAAA,KAAe,OAAOC,KAAA,CAAMC,OAAA,CAAQH,GAAA,CAAIzB,IAAI,KAAKyB,GAAA,CAAIzB,IAAA,CAAK6B,MAAA,GAAS,GAAG;YAC5E,IAAMC,GAAA,GAAML,GAAA,CAAIzB,IAAA,CAAK,CAAC;YACtBe,KAAA,CAAKd,OAAA,GAAU;cACboB,KAAA,EAAOS,GAAA,CAAI,CAAC;cAAA;cACZC,IAAA,EAAMD,GAAA,CAAI,CAAC;cACXE,WAAA,EAAaF,GAAA,CAAI,CAAC;YAAA;iBAEf;YACLZ,aAAA,CAAGC,KAAA,CAACc,SAAA,CAAU;cAAEZ,KAAA,EAAO;cAASa,IAAA,EAAM;YAAK,CAAG;UAChD;QACD;QACDC,IAAA,EAAM,SAAAA,KAAA,EAAM;UACVjB,aAAA,CAAGC,KAAA,CAACc,SAAA,CAAU;YAAEZ,KAAA,EAAO;YAAca,IAAA,EAAM;UAAO,CAAC;QACpD;QACDE,QAAA,EAAU,SAAAA,SAAA,EAAM;UACdlB,aAAA,CAAGC,KAAA,CAACkB,WAAA,EAAW;UACftB,KAAA,CAAKb,MAAA,GAAS;QAChB;MACF,CAAC;IACF;IACDoC,aAAA,WAAAA,cAAcP,IAAA,EAAM;MAUlBb,aAAA,CAAAC,KAAA,CAAIc,SAAA,CAAU;QACZZ,KAAA,EAAO;QACPa,IAAA,EAAM;MACR,CAAC;IAEH;EACD;EACDK,MAAA,WAAAA,OAAOC,OAAA,EAAS;IACd,IAAIA,OAAA,oBAAAA,OAAA,CAASrC,EAAA,EAAI;MACf,KAAKA,EAAA,GAAKqC,OAAA,CAAQrC,EAAA;MAClB,KAAKW,gBAAA,CAAiB,KAAKX,EAAE;IAAA,OACxB;MACLe,aAAA,CAAGC,KAAA,CAACc,SAAA,CAAU;QAAEZ,KAAA,EAAO;QAAQa,IAAA,EAAM;MAAK,CAAG;MAC7C,KAAKhC,MAAA,GAAS;IAChB;EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;ACzGAuC,EAAA,CAAGC,UAAA,CAAWC,eAAe","ignoreList":[]}