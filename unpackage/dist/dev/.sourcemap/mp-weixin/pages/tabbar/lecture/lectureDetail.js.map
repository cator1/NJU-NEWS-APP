{"version":3,"file":"lectureDetail.js","sources":["pages/tabbar/lecture/lectureDetail.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGFiYmFyL2xlY3R1cmUvbGVjdHVyZURldGFpbC52dWU"],"sourcesContent":["<template>\n  <view class=\"lecture-detail\">\n    <!-- 骨架屏占位（加载中） -->\n    <view v-if=\"!loaded\" class=\"skeleton\">\n      <view class=\"skeleton-title\"></view>\n      <view class=\"skeleton-line\" v-for=\"n in 4\" :key=\"n\"></view>\n      <view class=\"skeleton-link\"></view>\n    </view>\n\n    <!-- 正式内容 -->\n    <view v-else>\n      <view v-if=\"lecture\">\n        <text class=\"title\" user-select>{{ lecture.title }}</text>\n        <view class=\"desc\">\n          <text user-select>{{ lecture.description }}</text>\n        </view>\n        <view v-if=\"lecture.link\" class=\"link\">\n          <text @click=\"openInBrowser(lecture.link)\">查看原文链接</text>\n        </view>\n      </view>\n\n      <!-- 加载完成但未找到讲座 -->\n      <view v-else class=\"error\">\n        <text>讲座不存在</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n\n<script>\nimport { useUserStore } from '../../../store/user'\n\nexport default {\n  data() {\n    return {\n      lecture: null,\r\n\t  loaded: false,\r\n\t  id:null\n    };\n  },\n  // computed: {\n  //   userStore() {\n  //     return useUserStore()\n  //   }\n  // },\r\n  methods:{\r\n    fetchLectureById(id) {\n      if (!id) return;\n      const url = `http://52.184.65.42/api/query?id=${id}`;\n      uni.showLoading({ title: '加载中...' });\n\n      uni.request({\r\n        url,\r\n        method: 'GET',\r\n        success: (res) => {\r\n          if (res.statusCode === 200 && Array.isArray(res.data) && res.data.length > 0) {\r\n            const row = res.data[0];\r\n            this.lecture = {\r\n              title: row[3],\r\n              link: row[4],\r\n              description: row[5]\r\n            };\r\n          } else {\r\n            uni.showToast({ title: '讲座未找到', icon: 'none' });\r\n          }\r\n        },\r\n        fail: () => {\r\n          uni.showToast({ title: '请求失败，启用备用地址', icon: 'none' });\r\n      \r\n          // 获取备用地址\r\n          uni.request({\r\n            url: 'https://nik-nul.github.io/keep/url.txt',\r\n            method: 'GET',\r\n            success: (backres) => {\r\n              const newBaseurl = backres.data.trim();\r\n\t\t\t  if(!newBaseurl){\r\n\t\t\t\t  console.error('备用地址为空');\r\n\t\t\t\t  return;\r\n\t\t\t  }\r\n\t\t\t  \r\n              const newurl = `http://${newBaseurl}/api/query?id=${id}`;\r\n              uni.request({\r\n                url: newurl,\r\n                method: 'GET',\r\n                success: (res2) => {\r\n                  if (res2.statusCode === 200 && Array.isArray(res2.data) && res2.data.length > 0) {\r\n                    const row = res2.data[0];\r\n                    this.lecture = {\r\n                      title: row[3],\r\n                      link: row[4],\r\n                      description: row[5]\r\n                    };\r\n                  } else {\r\n                    uni.showToast({ title: '备用地址查询失败', icon: 'none' });\r\n                  }\r\n                },\r\n                fail: () => {\r\n                  uni.showToast({ title: '备用地址请求失败', icon: 'none' });\r\n                },\r\n                complete: () => {\r\n                  uni.hideLoading();\r\n                  this.loaded = true;\r\n                }\r\n              });\r\n            },\r\n            fail: () => {\r\n              uni.showToast({ title: '无法获取备用地址', icon: 'none' });\r\n              uni.hideLoading();\r\n              this.loaded = true;\r\n            }\r\n          });\r\n        },\r\n        complete: () => {\r\n          if (!this.loaded) {\r\n            uni.hideLoading();\r\n            this.loaded = true;\r\n          }\r\n        }\r\n      });\r\n\n    },\r\n    openInBrowser(link) {\n      // #ifdef APP-PLUS\n      if (link) {\n        plus.runtime.openURL(link, function (res) {\n          console.log('打开外链失败', res);\n        });\n      }\n      // #endif\n\n      // #ifndef APP-PLUS\n      uni.showToast({\n        title: '仅支持App中打开外链',\n        icon: 'none'\n      });\n      // #endif\n    }\r\n  },\n  onLoad(options) {\n    if (options?.id) {\n      this.id = options.id;\n      this.fetchLectureById(this.id);\n    } else {\n      uni.showToast({ title: '参数缺失', icon: 'none' });\n      this.loaded = true;\n    }\n  }\n}\n</script>\n\n<style>\n.lecture-detail {\n  padding: 20rpx;\n}\n.title {\n  font-size: 20px;\n  font-weight: bold;\n  margin-bottom: 16rpx;\n}\n.desc {\n  font-size: 14px;\n  line-height: 1.8;\n  color: #333;\n  white-space: pre-wrap;\n}\n.link {\n  margin-top: 20rpx;\r\n  color: #00007f;\n}\n.error {\n  color: red;\n  font-size: 16px;\n  text-align: center;\n  margin-top: 100rpx;\n}\r\n\r\n/* 骨架屏结构样式 */\n.skeleton {\n  padding: 20rpx;\n}\n.skeleton-title {\n  width: 70%;\n  height: 28rpx;\n  background-color: #eee;\n  border-radius: 6rpx;\n  margin-bottom: 24rpx;\n}\n.skeleton-line {\n  width: 100%;\n  height: 18rpx;\n  background-color: #eee;\n  border-radius: 6rpx;\n  margin-bottom: 16rpx;\n}\n.skeleton-link {\n  width: 40%;\n  height: 24rpx;\n  background-color: #ddd;\n  border-radius: 6rpx;\n  margin-top: 20rpx;\n}\n\n</style>\r\n","import MiniProgramPage from 'D:/NJU/code/NJUnews/code/njunews/pages/tabbar/lecture/lectureDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}