{"version":3,"file":"upgrade-popup.js","sources":["uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXMvdW5pLXVwZ3JhZGUtY2VudGVyLWFwcC9wYWdlcy91cGdyYWRlLXBvcHVwLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"mask flex-center\" v-if=\"shown\">\n\t\t<view class=\"content botton-radius\">\n\t\t\t<view class=\"content-top\">\n\t\t\t\t<text class=\"content-top-text\">{{ title }}</text>\n\t\t\t\t<image class=\"content-top\" style=\"top: 0\" width=\"100%\" height=\"100%\" src=\"/uni_modules/uni-upgrade-center-app/static/app/bg_top.png\"></image>\n\t\t\t</view>\n\t\t\t<view class=\"content-header\"></view>\n\t\t\t<view class=\"content-body\">\n\t\t\t\t<view class=\"title\">\n\t\t\t\t\t<text>{{ subTitle }}</text>\n\t\t\t\t\t<text class=\"content-body-version\">{{ version }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"body\">\n\t\t\t\t\t<scroll-view class=\"box-des-scroll\" scroll-y=\"true\">\n\t\t\t\t\t\t<text class=\"box-des\">\n\t\t\t\t\t\t\t{{ contents }}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</scroll-view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"footer flex-center\">\n\t\t\t\t\t<template v-if=\"isApplicationStore\">\n\t\t\t\t\t\t<button class=\"content-button\" style=\"border: none; color: #fff\" plain @click=\"jumpToApplicationStore\">\n\t\t\t\t\t\t\t{{ downLoadBtnTextiOS }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<template v-if=\"!downloadSuccess\">\n\t\t\t\t\t\t\t<view class=\"progress-box flex-column\" v-if=\"downloading\">\n\t\t\t\t\t\t\t\t<progress class=\"progress\" :percent=\"downLoadPercent\" activeColor=\"#3DA7FF\" show-info stroke-width=\"10\" />\n\t\t\t\t\t\t\t\t<view style=\"width: 100%; font-size: 28rpx; display: flex; justify-content: space-around\">\n\t\t\t\t\t\t\t\t\t<text>{{ downLoadingText }}</text>\n\t\t\t\t\t\t\t\t\t<text>({{ downloadedSize }}/{{ packageFileSize }}M)</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t\t<button v-else class=\"content-button\" style=\"border: none; color: #fff\" plain @click=\"updateApp\">\n\t\t\t\t\t\t\t\t{{ downLoadBtnText }}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tv-else-if=\"downloadSuccess && !installed\"\n\t\t\t\t\t\t\tclass=\"content-button\"\n\t\t\t\t\t\t\tstyle=\"border: none; color: #fff\"\n\t\t\t\t\t\t\tplain\n\t\t\t\t\t\t\t:loading=\"installing\"\n\t\t\t\t\t\t\t:disabled=\"installing\"\n\t\t\t\t\t\t\t@click=\"installPackage\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ installing ? '正在安装……' : '下载完成，立即安装' }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tv-else-if=\"installed && !isWGT\"\n\t\t\t\t\t\t\tclass=\"content-button\"\n\t\t\t\t\t\t\tstyle=\"border: none; color: #fff\"\n\t\t\t\t\t\t\tplain\n\t\t\t\t\t\t\t:loading=\"installing\"\n\t\t\t\t\t\t\t:disabled=\"installing\"\n\t\t\t\t\t\t\t@click=\"installPackage\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t安装未完成，点击安装\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<button v-else-if=\"installed && isWGT\" class=\"content-button\" style=\"border: none; color: #fff\" plain @click=\"restart\">安装完毕，点击重启</button>\n\t\t\t\t\t</template>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<image v-if=\"!is_mandatory\" class=\"close-img\" src=\"/uni_modules/uni-upgrade-center-app/static/app/app_update_close.png\" @click.stop=\"closeUpdate\"></image>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n// #ifdef APP-PLUS\nimport { createNotificationProgress, cancelNotificationProgress, finishNotificationProgress } from '@/uni_modules/uts-progressNotification';\n// #endif\nimport { compare, platform_iOS, platform_Android, platform_Harmony } from '../utils/utils'\nconst localFilePathKey = 'UNI_ADMIN_UPGRADE_CENTER_LOCAL_FILE_PATH';\n\nlet downloadTask = null;\nlet openSchemePromise;\n\nexport default {\n    emits: ['close', 'show'],\n\tdata() {\n\t\treturn {\n\t\t\t// 从之前下载安装\n\t\t\tinstallForBeforeFilePath: '',\n\n\t\t\t// 安装\n\t\t\tinstalled: false,\n\t\t\tinstalling: false,\n\n\t\t\t// 下载\n\t\t\tdownloadSuccess: false,\n\t\t\tdownloading: false,\n\n\t\t\tdownLoadPercent: 0,\n\t\t\tdownloadedSize: 0,\n\t\t\tpackageFileSize: 0,\n\n\t\t\ttempFilePath: '', // 要安装的本地包地址\n\n\t\t\t// 默认安装包信息\n\t\t\ttitle: '更新日志',\n\t\t\tcontents: '',\n\t\t\tversion: '',\n\t\t\tis_mandatory: false,\n\t\t\turl: '',\n\t\t\tplatform: [],\n\t\t\tstore_list: null,\n\n\t\t\t// 可自定义属性\n\t\t\tsubTitle: '发现新版本',\n\t\t\tdownLoadBtnTextiOS: '立即跳转更新',\n\t\t\tdownLoadBtnText: '立即下载更新',\n\t\t\tdownLoadingText: '安装包下载中，请稍后',\n\n\t\t\t// #ifdef APP-PLUS\n\t\t\tshown: true,\n\t\t\t// #endif\n\t\t\t// #ifdef APP-HARMONY\n\t\t\tshown: false,\n\t\t\t// #endif\n\t\t};\n\t},\n\tonLoad({ local_storage_key }) {\n\t\tif (!local_storage_key) {\n\t\t\tconsole.error('local_storage_key为空，请检查后重试');\n\t\t\tuni.navigateBack();\n\t\t\treturn;\n\t\t}\n\n\t\tconst localPackageInfo = uni.getStorageSync(local_storage_key);\n\t\tif (!localPackageInfo) {\n\t\t\tconsole.error('安装包信息为空，请检查后重试');\n\t\t\tuni.navigateBack();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setLocalPackageInfo(localPackageInfo)\n\t},\n\tonBackPress() {\n\t\t// 强制更新不允许返回\n\t\tif (this.is_mandatory) return true;\n\t\tif (!this.needNotificationProgress) downloadTask && downloadTask.abort();\n\t},\n\tonHide() {\n\t\topenSchemePromise = null;\n\t},\n\tcomputed: {\n\t\tisWGT() {\n\t\t\treturn this.type === 'wgt';\n\t\t},\n\t\tisNativeApp() {\n\t\t\treturn this.type === 'native_app';\n\t\t},\n\t\tisiOS() {\n\t\t\treturn this.platform.indexOf(platform_iOS) !== -1;\n\t\t},\n\t\tisAndroid() {\n\t\t\treturn this.platform.indexOf(platform_Android) !== -1;\n\t\t},\n\t\tisHarmony() {\n\t\t\treturn this.platform.indexOf(platform_Harmony) !== -1;\n\t\t},\n\t\tisApplicationStore() {\n\t\t\treturn !this.isWGT && this.isNativeApp && (\n\t\t\t\tthis.isiOS ||\n\t\t\t\tthis.isHarmony\n\t\t\t)\n\t\t\t// return this.isiOS || (!this.isiOS && !this.isWGT && this.url.indexOf('.apk') === -1);\n\t\t},\n\t\tneedNotificationProgress() {\n\t\t\treturn this.platform.indexOf(platform_iOS) === -1 && !this.is_mandatory && !this.isHarmony;\n\t\t}\n\t},\n\tmethods: {\n\t\tshow(shown, localPackageInfo) {\n\t\t\t// #ifdef APP-HARMONY\n\t\t\tthis.$emit('show')\n\t\t\tif (localPackageInfo) {\n\t\t\t\tthis.shown = shown\n\t\t\t\tthis.setLocalPackageInfo(localPackageInfo)\n\t\t\t} else {\n\t\t\t\tconsole.error(`安装包信息为空，请检查后重试`);\n\t\t\t}\n\t\t\t// #endif\n\t\t},\n\t\tsetLocalPackageInfo(localPackageInfo) {\n\t\t\tconst requiredKey = ['version', 'url', 'type'];\n\t\t\tfor (let key in localPackageInfo) {\n\t\t\t\tif (requiredKey.indexOf(key) !== -1 && !localPackageInfo[key]) {\n\t\t\t\t\tconsole.error(`参数 ${key} 必填，请检查后重试`);\n\t\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t// #endif\n\t\t\t\t\t// #ifdef APP-HARMONY\n\t\t\t\t\tthis.shown = false\n\t\t\t\t\t// #endif\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tObject.assign(this, localPackageInfo);\n\t\t\tthis.checkLocalStoragePackage();\n\t\t},\n\t\tcheckLocalStoragePackage() {\n\t\t\t// 如果已经有下载好的包，则直接提示安装\n\t\t\tconst localFilePathRecord = uni.getStorageSync(localFilePathKey);\n\t\t\tif (localFilePathRecord) {\n\t\t\t\tconst { version, savedFilePath, installed } = localFilePathRecord;\n\n\t\t\t\t// 比对版本\n\t\t\t\tif (!installed && compare(version, this.version) === 0) {\n\t\t\t\t\tthis.downloadSuccess = true;\n\t\t\t\t\tthis.installForBeforeFilePath = savedFilePath;\n\t\t\t\t\tthis.tempFilePath = savedFilePath;\n\t\t\t\t} else {\n\t\t\t\t\t// 如果保存的包版本小 或 已安装过，则直接删除\n\t\t\t\t\tthis.deleteSavedFile(savedFilePath);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\taskAbortDownload() {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '是否取消下载？',\n\t\t\t\tcancelText: '否',\n\t\t\t\tconfirmText: '是',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tdownloadTask && downloadTask.abort();\r\n            if (this.needNotificationProgress) {\n              cancelNotificationProgress();\n            }\n\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tasync closeUpdate() {\n\t\t\tif (this.downloading) {\n\t\t\t\tif (this.is_mandatory) {\n\t\t\t\t\treturn uni.showToast({\n\t\t\t\t\t\ttitle: '下载中，请稍后……',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 500\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (!this.needNotificationProgress) {\n\t\t\t\t\tthis.askAbortDownload();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!this.needNotificationProgress && this.downloadSuccess && this.tempFilePath) {\n\t\t\t\t// 包已经下载完毕，稍后安装，将包保存在本地\n\t\t\t\tawait this.saveFile(this.tempFilePath, this.version);\n\t\t\t}\n\n\t\t\t// #ifdef APP-PLUS\n\t\t\tuni.navigateBack();\n\t\t\t// #endif\n\t\t\t// #ifdef APP-HARMONY\n\t\t\tthis.shown = false\n\t\t\tthis.$emit('close')\n\t\t\t// #endif\n\t\t},\n\t\tupdateApp() {\n\t\t\tthis.checkStoreScheme()\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.downloadPackage();\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\topenSchemePromise = null;\n\t\t\t\t});\n\t\t},\n\t\t// 跳转应用商店\n\t\tcheckStoreScheme() {\n\t\t\tconst storeList = (this.store_list || []).filter((item) => item.enable);\n\t\t\tif (storeList && storeList.length) {\n\t\t\t\tstoreList\n\t\t\t\t\t.sort((cur, next) => next.priority - cur.priority)\n\t\t\t\t\t.map((item) => item.scheme)\n\t\t\t\t\t.reduce((promise, cur, curIndex) => {\n\t\t\t\t\t\topenSchemePromise = (promise || (promise = Promise.reject())).catch(() => {\n\t\t\t\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\t\t\tplus.runtime.openURL(cur, (err) => {\n\t\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn openSchemePromise;\n\t\t\t\t\t}, openSchemePromise);\n\t\t\t\treturn openSchemePromise;\n\t\t\t}\n\n\t\t\treturn Promise.reject();\n\t\t},\n\t\tdownloadPackage() {\n\t\t\tthis.downloading = true;\n\t\t\t//下载包\n\t\t\tdownloadTask = uni.downloadFile({\n\t\t\t\turl: this.url,\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\t// fix: wgt 文件下载完成后后缀不是 wgt\n\t\t\t\t\t\tif (this.isWGT && res.tempFilePath.split('.').slice(-1)[0] !== 'wgt') {\n\t\t\t\t\t\t\tconst failCallback = (e) => {\n\t\t\t\t\t\t\t\tconsole.log('[FILE RENAME FAIL]：', JSON.stringify(e));\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t// #ifndef APP-HARMONY\n\t\t\t\t\t\t\tplus.io.resolveLocalFileSystemURL(\n\t\t\t\t\t\t\t\tres.tempFilePath,\n\t\t\t\t\t\t\t\t(entry) => {\n\t\t\t\t\t\t\t\t\tentry.getParent((parent) => {\n\t\t\t\t\t\t\t\t\t\tconst newName = `new_wgt_${Date.now()}.wgt`;\n\t\t\t\t\t\t\t\t\t\tentry.copyTo(\n\t\t\t\t\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\t\t\t\t\tnewName,\n\t\t\t\t\t\t\t\t\t\t\t(res) => {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.tempFilePath = res.fullPath;\n\t\t\t\t\t\t\t\t\t\t\t\tthis.downLoadComplete();\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tfailCallback\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}, failCallback);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfailCallback\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t\t// #ifdef APP-HARMONY\n\t\t\t\t\t\t\tfailCallback({code: -1, message: 'Download content error, is not wgt.'})\n\t\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.tempFilePath = res.tempFilePath;\n\t\t\t\t\t\t\tthis.downLoadComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('下载错误：' + JSON.stringify(res))\n            this.downloadFail()\n\t\t\t\t\t}\n\t\t\t\t},\n        fail: (err) => {\n          console.log('下载错误：' + JSON.stringify(err))\n          this.downloadFail()\n        }\n\t\t\t});\n\n\t\t\tdownloadTask.onProgressUpdate((res) => {\n\t\t\t\tthis.downLoadPercent = res.progress;\n\t\t\t\tthis.downloadedSize = (res.totalBytesWritten / Math.pow(1024, 2)).toFixed(2);\n\t\t\t\tthis.packageFileSize = (res.totalBytesExpectedToWrite / Math.pow(1024, 2)).toFixed(2);\n\n\t\t\t\tif (this.needNotificationProgress && !this.downloadSuccess) {\n\t\t\t\t\tcreateNotificationProgress({\n\t\t\t\t\t\ttitle: '升级中心正在下载安装包……',\n\t\t\t\t\t\tcontent: `${this.downLoadPercent}%`,\n\t\t\t\t\t\tprogress: this.downLoadPercent,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tthis.askAbortDownload();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (this.needNotificationProgress) {\n\t\t\t\tuni.navigateBack();\n\t\t\t}\n\t\t},\n    downloadFail() {\n      const errMsg = '下载失败，请点击重试'\n\n      this.downloadSuccess = false;\n      this.downloading = false;\n\n      this.downLoadPercent = 0;\n      this.downloadedSize = 0;\n      this.packageFileSize = 0;\n\n      this.downLoadBtnText = errMsg\n\n      downloadTask = null;\n\n      if (this.needNotificationProgress) {\n        finishNotificationProgress({\n          title: '升级包下载失败',\n          content: '请重新检查更新'\n        });\n      }\n    },\n\t\tdownLoadComplete() {\n\t\t\tthis.downloadSuccess = true;\n\t\t\tthis.downloading = false;\n\n\t\t\tthis.downLoadPercent = 0;\n\t\t\tthis.downloadedSize = 0;\n\t\t\tthis.packageFileSize = 0;\n\n\t\t\tdownloadTask = null;\n\n\t\t\tif (this.needNotificationProgress) {\n\t\t\t\tfinishNotificationProgress({\n\t\t\t\t\ttitle: '安装升级包',\n\t\t\t\t\tcontent: '下载完成'\n\t\t\t\t});\n\n\t\t\t\tthis.installPackage();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// 强制更新，直接安装\n\t\t\tif (this.is_mandatory) {\n\t\t\t\tthis.installPackage();\n\t\t\t}\n\t\t},\n\t\tinstallPackage() {\n\t\t\t// #ifdef APP-PLUS || APP-HARMONY\n\t\t\t// wgt资源包安装\n\t\t\tif (this.isWGT) {\n\t\t\t\tthis.installing = true;\n\t\t\t}\n\t\t\tplus.runtime.install(\n\t\t\t\tthis.tempFilePath,\n\t\t\t\t{\n\t\t\t\t\tforce: false\n\t\t\t\t},\n\t\t\t\tasync (res) => {\n\t\t\t\t\tthis.installing = false;\n\t\t\t\t\tthis.installed = true;\n\n\t\t\t\t\t// wgt包，安装后会提示 安装成功，是否重启\n\t\t\t\t\tif (this.isWGT) {\n\t\t\t\t\t\t// 强制更新安装完成重启\n\t\t\t\t\t\tif (this.is_mandatory) {\n\t\t\t\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\ttitle: '安装成功，正在重启……'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t// #endif\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t\t\tthis.restart();\n\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst localFilePathRecord = uni.getStorageSync(localFilePathKey);\n\t\t\t\t\t\tuni.setStorageSync(localFilePathKey, {\n\t\t\t\t\t\t\t...localFilePathRecord,\n\t\t\t\t\t\t\tinstalled: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tasync (err) => {\n\t\t\t\t\t// 如果是安装之前的包，安装失败后删除之前的包\n\t\t\t\t\tif (this.installForBeforeFilePath) {\n\t\t\t\t\t\tawait this.deleteSavedFile(this.installForBeforeFilePath);\n\t\t\t\t\t\tthis.installForBeforeFilePath = '';\n\t\t\t\t\t}\n\n\t\t\t\t\t// 安装失败需要重新下载安装包\n\t\t\t\t\tthis.installing = false;\n\t\t\t\t\tthis.installed = false;\n\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '更新失败，请重新下载',\n\t\t\t\t\t\tcontent: err.message,\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t// 非wgt包，安装跳出覆盖安装，此处直接返回上一页\n\t\t\tif (!this.isWGT && !this.is_mandatory) {\n\t\t\t\tuni.navigateBack();\n\t\t\t}\n\t\t\t// #endif\n\t\t},\n\t\trestart() {\n\t\t\tthis.installed = false;\n\t\t\t// #ifdef APP-HARMONY\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '更新完毕',\n\t\t\t\tcontent: '请手动重启',\n\t\t\t\tshowCancel: false,\n\t\t\t\tsuccess(res) {\n\t\t\t\t\tplus.runtime.quit()\n\t\t\t\t}\n\t\t\t})\n\t\t\t// #endif\n\t\t\t// #ifdef APP-PLUS\n\t\t\t//更新完重启app\n\t\t\tplus.runtime.restart();\n\t\t\t// #endif\n\t\t},\n\t\tsaveFile(tempFilePath, version) {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tuni.saveFile({\n\t\t\t\t\ttempFilePath,\n\t\t\t\t\tsuccess({ savedFilePath }) {\n\t\t\t\t\t\tuni.setStorageSync(localFilePathKey, {\n\t\t\t\t\t\t\tversion,\n\t\t\t\t\t\t\tsavedFilePath\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tdeleteSavedFile(filePath) {\n\t\t\tuni.removeStorageSync(localFilePathKey);\n\t\t\treturn uni.removeSavedFile({\n\t\t\t\tfilePath\n\t\t\t});\n\t\t},\n\t\tjumpToApplicationStore() {\n\t\t\tplus.runtime.openURL(this.url);\n\t\t}\n\t}\n};\n</script>\n\n<style>\npage {\n\tbackground: transparent;\n}\n\n.flex-center {\n\t/* #ifndef APP-NVUE */\n\tdisplay: flex;\n\t/* #endif */\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.mask {\n\tposition: fixed;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: rgba(0, 0, 0, 0.65);\n}\n\n.botton-radius {\n\tborder-bottom-left-radius: 30rpx;\n\tborder-bottom-right-radius: 30rpx;\n}\n\n.content {\n\tposition: relative;\n\ttop: 0;\n\twidth: 600rpx;\n\tbackground-color: #fff;\n\tbox-sizing: border-box;\n\tpadding: 0 50rpx;\n\tfont-family: Source Han Sans CN;\n}\n\n.text {\n\t/* #ifndef APP-NVUE */\n\tdisplay: block;\n\t/* #endif */\n\tline-height: 200px;\n\ttext-align: center;\n\tcolor: #ffffff;\n}\n\n.content-top {\n\tposition: absolute;\n\ttop: -195rpx;\n\tleft: 0;\n\twidth: 600rpx;\n\theight: 270rpx;\n}\n\n.content-top-text {\n\tfont-size: 45rpx;\n\tfont-weight: bold;\n\tcolor: #f8f8fa;\n\tposition: absolute;\n\ttop: 120rpx;\n\tleft: 50rpx;\n\tz-index: 1;\n}\n\n.content-header {\n\theight: 70rpx;\n}\n\n.title {\n\tfont-size: 33rpx;\n\tfont-weight: bold;\n\tcolor: #3da7ff;\n\tline-height: 38px;\n}\n\n.content-body {\n  width: 100%;\n}\n\n.content-body-version {\n\tpadding-left: 20rpx;\n\tcolor: #fff;\n\tfont-size: 20rpx;\n\tmargin-left: 10rpx;\n\tpadding: 4rpx 8rpx;\n\tborder-radius: 20rpx;\n\tbackground: #50aefd;\n}\n\n.footer {\n\theight: 150rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-around;\n}\n\n.box-des-scroll {\n\tbox-sizing: border-box;\n\tpadding: 0 40rpx;\n\theight: 200rpx;\n\ttext-align: left;\n}\n\n.box-des {\n\tfont-size: 26rpx;\n\tcolor: #000000;\n\tline-height: 50rpx;\n}\n\n.progress-box {\n\twidth: 100%;\n}\n\n.progress {\n\twidth: 90%;\n\theight: 40rpx;\n\t/* border-radius: 35px; */\n}\n\n.close-img {\n\twidth: 70rpx;\n\theight: 70rpx;\n\tz-index: 1000;\n\tposition: absolute;\n\tbottom: -120rpx;\n\tleft: calc(50% - 70rpx / 2);\n}\n\n.content-button {\n\ttext-align: center;\n\tflex: 1;\n\tfont-size: 30rpx;\n\tfont-weight: 400;\n\tcolor: #ffffff;\n\tborder-radius: 40rpx;\n\tmargin: 0 18rpx;\n\n\theight: 80rpx;\n\tline-height: 80rpx;\n\n\tbackground: linear-gradient(to right, #1785ff, #3da7ff);\n}\n\n.flex-column {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n}\n</style>\n","import MiniProgramPage from 'D:/NJU/code/NJUnews/code/njunews/uni_modules/uni-upgrade-center-app/pages/upgrade-popup.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","platform_iOS","platform_Android","platform_Harmony","compare","res"],"mappings":"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"}